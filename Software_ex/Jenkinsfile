 pipeline {
    agent any

    environment {
        CLASSPATH = "classes;lib/;path/to/eclipse/plugins/junit-platform-console-standalone-1.7.1.jar"
    }
  
    stages {
        stage('Checkout') {
            steps {
                // 소스코드 체크아웃
                checkout scm
            }
        }
        stage('Build') {
          steps {
              script {
                  // Clean and compile the Java project
                  sh 'javac -cp $CLASSPATH src/**/*.java -d classes'
              }
          }
      }
      stage('Test') {
          steps {
              script {
                  // Run tests using the specified classpath
                  sh 'java -cp $CLASSPATH org.junit.runner.JUnitCore com.example.MyTestClass'
              }
          }
      }
    } 
post {
        always {
            // 테스트 결과 파일을 저장하기 위해 아카이브
            archiveArtifacts 'test_results.txt'
        }
        failure {
            echo 'Build or test failed'
        }
        success {
            echo 'Build and test succeeded'
        }
    }
 }
